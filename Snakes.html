<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Color-Chaser Snake â€” Hub</title>
<style>
  :root{--bg:#000;--fg:#fff;}
  html,body{margin:0;padding:0;height:100%;background:var(--bg);color:var(--fg);font-family:Arial,Helvetica,sans-serif;display:flex;justify-content:center;align-items:center;overflow:hidden;}
  canvas{background:#111;border:2px solid #fff;border-radius:6px;display:block;}
  .menu{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:12px;background:rgba(0,0,0,0.85);}
  .menu button{padding:10px 20px;font-size:18px;border-radius:6px;border:1px solid #fff;background:transparent;color:#fff;cursor:pointer;}
  .menu .points{margin-top:10px;font-size:16px;}
  #skinSelect{margin-top:10px;padding:5px;font-size:16px;border-radius:6px;border:1px solid #fff;background:#000;color:#fff;}
</style>
</head>
<body>
<canvas id="game" width="400" height="400" tabindex="0"></canvas>

<div class="menu" id="menu">
  <button id="startBtn">Start Game</button>
  <button id="casesBtn">Open Case (5 points)</button>
  <div class="points" id="pointsDisplay">Points: 0</div>
  <label for="skinSelect" class="points">Select Skin:</label>
  <select id="skinSelect"></select>
</div>

<script>
(() => {
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const menu = document.getElementById('menu');
const startBtn = document.getElementById('startBtn');
const casesBtn = document.getElementById('casesBtn');
const pointsDisplay = document.getElementById('pointsDisplay');
const skinSelect = document.getElementById('skinSelect');

const CELL = 15, COLS = canvas.width / CELL, ROWS = canvas.height / CELL;
const MOVE_INTERVAL = 120;

// Snake state
let snake = [{x:10, y:10}];
let dir = {x:0, y:0}, nextDir = {x:0, y:0};
let grow = 0;

// Hub/game flags
let inHub = true;  // True: menu hub, False: real game
let running = false;

// Points and skins
let points = 0;
let ownedSkins = ['white'];
let currentSkin = 'white';

function drawHub(){
    ctx.fillStyle = '#111';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    snake.forEach((s,i)=>{
        ctx.fillStyle = i===0?currentSkin:`rgb(${220-i*10},${220-i*10},${220-i*10})`;
        ctx.fillRect(s.x*CELL+1,s.y*CELL+1,CELL-2,CELL-2);
    });
    ctx.fillStyle='white';
    ctx.font='16px Arial';
    ctx.fillText('Hub - Move your snake around', 10, 20);
    ctx.fillText('Points: '+points, 10, 40);
}

function drawGame(){
    ctx.fillStyle='#111';
    ctx.fillRect(0,0,canvas.width,canvas.height);
    snake.forEach((s,i)=>{
        ctx.fillStyle = i===0?currentSkin:`rgb(${220-i*10},${220-i*10},${220-i*10})`;
        ctx.fillRect(s.x*CELL+1,s.y*CELL+1,CELL-2,CELL-2);
    });
}

function updateHubSnake(){
    const head = {x:snake[0].x + dir.x, y:snake[0].y + dir.y};
    // Prevent leaving hub boundaries
    head.x = Math.max(0, Math.min(COLS-1, head.x));
    head.y = Math.max(0, Math.min(ROWS-1, head.y));
    snake.unshift(head);
    if(grow>0) grow--;
    else snake.pop();
}

function hubLoop(){
    updateHubSnake();
    drawHub();
    if(inHub) requestAnimationFrame(hubLoop);
}

function startGame(){
    inHub = false;
    dir = {x:1,y:0};
    nextDir = dir;
    running = true;
    snake = [{x:10,y:10,color:currentSkin},{x:9,y:10,color:'#555'},{x:8,y:10,color:'#333'}];
    menu.style.display='none';
    canvas.focus();
}

// Controls
window.addEventListener('keydown', e=>{
    const k = e.key;
    if(k==='ArrowUp'||k==='w'||k==='W') nextDir={x:0,y:-1};
    else if(k==='ArrowDown'||k==='s'||k==='S') nextDir={x:0,y:1};
    else if(k==='ArrowLeft'||k==='a'||k==='A') nextDir={x:-1,y:0};
    else if(k==='ArrowRight'||k==='d'||k==='D') nextDir={x:1,y:0};
});

// Hub movement uses nextDir if inHub
setInterval(()=>{
    if(inHub){
        dir = nextDir;
    }
}, MOVE_INTERVAL);

// Skin selection
function updateSkinSelect(){
  skinSelect.innerHTML='';
  ownedSkins.forEach(skin=>{
    const opt = document.createElement('option');
    opt.value = skin; opt.textContent = skin.charAt(0).toUpperCase()+skin.slice(1);
    if(skin===currentSkin) opt.selected=true;
    skinSelect.appendChild(opt);
  });
}
skinSelect.addEventListener('change', e=>{
  currentSkin = e.target.value;
});

updateSkinSelect();

// Start hub loop
hubLoop();

startBtn.addEventListener('click', startGame);

})();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Doom-like Game</title>
<style>
  body { margin: 0; overflow: hidden; background: black; }
  canvas { display: block; }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const map = [
  [1,1,1,1,1,1,1,1],
  [1,0,0,0,0,0,0,1],
  [1,0,1,0,1,0,0,1],
  [1,0,1,0,0,0,0,1],
  [1,0,0,0,1,0,0,1],
  [1,1,1,1,1,1,1,1],
];

const tileSize = 64;

let player = {
  x: tileSize * 1.5,
  y: tileSize * 1.5,
  angle: 0,
  speed: 2
};

const keys = {};

document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

function castRays() {
  const numRays = canvas.width;
  const fov = Math.PI / 3;

  for (let i = 0; i < numRays; i++) {
    const rayAngle = (player.angle - fov/2) + (i / numRays) * fov;
    let distance = 0;
    let hit = false;

    let sin = Math.sin(rayAngle);
    let cos = Math.cos(rayAngle);

    while (!hit && distance < 500) {
      distance += 1;
      let testX = Math.floor((player.x + cos * distance) / tileSize);
      let testY = Math.floor((player.y + sin * distance) / tileSize);

      if (map[testY][testX] === 1) hit = true;
    }

    const wallHeight = (tileSize * 300) / distance;
    ctx.fillStyle = 'gray';
    ctx.fillRect(i, (canvas.height / 2) - wallHeight/2, 1, wallHeight);
  }
}

function movePlayer() {
  if (keys['ArrowUp']) {
    player.x += Math.cos(player.angle) * player.speed;
    player.y += Math.sin(player.angle) * player.speed;
  }
  if (keys['ArrowDown']) {
    player.x -= Math.cos(player.angle) * player.speed;
    player.y -= Math.sin(player.angle) * player.speed;
  }
  if (keys['ArrowLeft']) player.angle -= 0.05;
  if (keys['ArrowRight']) player.angle += 0.05;
}

function gameLoop() {
  ctx.fillStyle = 'black';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  movePlayer();
  castRays();

  requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>

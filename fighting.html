document.write(`
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Fighting Game â€” Chromebook</title>
<style>
  html, body { margin:0; padding:0; height:100%; background:#111; color:#fff; font-family:Arial,sans-serif; overflow:hidden; }
  canvas { display:block; margin:0 auto; background:#222; border:4px solid #555; }
  .info { text-align:center; margin-top:4px; font-size:14px; }
</style>
</head>
<body>
<canvas id="gameCanvas" width="800" height="400" tabindex="0"></canvas>
<div class="info">Player 1: Arrows + Enter | Player 2: WASD + Space</div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');

  const G = 0.6; // gravity
  const FRICTION = 0.85;
  const FLOOR = 350;
  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  class Fighter {
    constructor(x, color, keys) {
      this.x = x;
      this.y = FLOOR;
      this.w = 40;
      this.h = 80;
      this.color = color;
      this.vx = 0;
      this.vy = 0;
      this.onGround = true;
      this.hp = 100;
      this.keys = keys;
      this.attackCooldown = 0;
      this.attackBox = {x:0, y:0, w:0, h:0, active:false};
    }
    move(keyState) {
      // horizontal movement
      if(keyState[this.keys.left]) this.vx = -5;
      else if(keyState[this.keys.right]) this.vx = 5;
      else this.vx *= FRICTION;

      // jump
      if(keyState[this.keys.jump] && this.onGround){
        this.vy = -12;
        this.onGround = false;
      }

      // attack
      if(keyState[this.keys.attack] && this.attackCooldown <= 0){
        this.attackCooldown = 30;
        this.attackBox.active = true;
        this.attackBox.w = 30;
        this.attackBox.h = 20;
        this.attackBox.y = this.y - this.h/2;
        this.attackBox.x = (this.color==='red') ? this.x+this.w : this.x-30;
      }
    }
    update() {
      this.x += this.vx;
      this.y += this.vy;
      if(!this.onGround) this.vy += G;

      // floor collision
      if(this.y >= FLOOR){
        this.y = FLOOR;
        this.vy = 0;
        this.onGround = true;
      }

      // bounds
      this.x = Math.max(0, Math.min(WIDTH - this.w, this.x));

      // cooldown
      if(this.attackCooldown > 0) this.attackCooldown--;
      if(this.attackCooldown === 0) this.attackBox.active = false;
    }
    draw() {
      // fighter
      ctx.fillStyle = this.color;
      ctx.fillRect(this.x, this.y - this.h, this.w, this.h);
      // attack
      if(this.attackBox.active){
        ctx.fillStyle = '#fff';
        ctx.fillRect(this.attackBox.x, this.attackBox.y, this.attackBox.w, this.attackBox.h);
      }
    }
  }

  const keys = {};
  const player1 = new Fighter(100, 'red', {left:'ArrowLeft', right:'ArrowRight', jump:'ArrowUp', attack:'Enter'});
  const player2 = new Fighter(600, 'blue', {left:'a', right:'d', jump:'w', attack:' '});
  const fighters = [player1, player2];

  function rectCollision(a,b){
    return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
  }

  function update() {
    fighters.forEach(f => f.move(keys));
    fighters.forEach(f => f.update());

    // handle attacks
    if(player1.attackBox.active && rectCollision(player1.attackBox, player2)){
      player2.hp -= 1;
      player2.vx += 3; // knockback
    }
    if(player2.attackBox.active && rectCollision(player2.attackBox, player1)){
      player1.hp -= 1;
      player1.vx -= 3;
    }

    // check round end
    fighters.forEach(f => {
      if(f.hp <= 0){
        f.hp = 100;
        player1.x = 100;
        player2.x = 600;
      }
    });
  }

  function draw() {
    ctx.clearRect(0,0,WIDTH,HEIGHT);
    // floor
    ctx.fillStyle = '#444';
    ctx.fillRect(0,FLOOR,WIDTH, HEIGHT-FLOOR);
    // health bars
    ctx.fillStyle = 'red';
    ctx.fillRect(20,20, player1.hp*2, 20);
    ctx.strokeStyle = '#fff';
    ctx.strokeRect(20,20,200,20);
    ctx.fillStyle = 'blue';
    ctx.fillRect(WIDTH-220,20, player2.hp*2, 20);
    ctx.strokeStyle = '#fff';
    ctx.strokeRect(WIDTH-220,20,200,20);

    fighters.forEach(f => f.draw());
  }

  function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
  }

  window.addEventListener('keydown', e => keys[e.key] = true);
  window.addEventListener('keyup', e => keys[e.key] = false);

  loop();
})();
</script>
</body>
</html>
`);
